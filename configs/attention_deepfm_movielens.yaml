model_name: attention_deepfm
seed: 42
device: auto
output_dir: ./outputs/attention_deepfm_movielens

data:
  dataset_name: movielens-100k
  data_dir: ./data/ml-100k
  split_strategy: leave_one_out
  min_interactions: 3
  label_threshold: 4.0
  num_neg_train: 4
  num_neg_eval: 999
  auto_download: true
  seed: 42

feature:
  embedding_l2_reg: 1.0e-5
  fm_embedding_dim: 16

fm:
  use_first_order: true
  use_second_order: true

dnn:
  hidden_units: [256, 128, 64]
  activation: relu
  dropout: 0.1
  use_batch_norm: true

attention:
  num_heads: 4
  attention_dim: 64
  dropout: 0.1
  num_layers: 1
  use_residual: true

training:
  batch_size: 4096
  learning_rate: 1.0e-3
  weight_decay: 1.0e-5
  epochs: 50
  optimizer: adam
  scheduler: reduce_on_plateau
  scheduler_patience: 3
  scheduler_factor: 0.5
  early_stopping_patience: 5
  early_stopping_metric: hr@10
  early_stopping_mode: max
  gradient_clip_norm: 1.0
  num_workers: 0
  pin_memory: false
